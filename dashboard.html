<!-- /client/admin/dashboard.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - ShopSavvy</title>
  <link rel="stylesheet" href="/css/admin.css" />
</head>
<body>
  <nav class="navbar">
    <div class="logo">ShopSavvy Admin</div>
    <ul class="nav-links">
      <li><a href="dashboard.html">Dashboard</a></li>
      <li><a href="add-product.html">Add Product</a></li>
      <li><a href="#" onclick="logout()">Logout</a></li>
    </ul>
  </nav>

  <section class="container">
    <h2>All Products</h2>
    <div id="product-list" class="product-grid"></div>
  </section>

  <script>
    const token = localStorage.getItem('adminToken');
    if (!token) window.location.href = '/client/admin/login.html';

    fetch('/api/admin/products', {
      headers: { 'Authorization': 'Bearer ' + token }
    })
    .then(res => res.json())
    .then(products => {
      const list = document.getElementById('product-list');
      list.innerHTML = products.map(p => `
        <div class="card">
          <img src="${p.image}" alt="${p.name}" />
          <h3>${p.name}</h3>
          <p>â‚¹${p.price}</p>
          <button onclick="editProduct('${p._id}')">Edit</button>
          <button onclick="deleteProduct('${p._id}')">Delete</button>
        </div>
      `).join('');
    });

    function editProduct(id) {
      window.location.href = `edit-product.html?id=${id}`;
    }

    async function deleteProduct(id) {
      if (!confirm('Are you sure you want to delete this product?')) return;
      const res = await fetch(`/api/admin/products/${id}`, {
        method: 'DELETE',
        headers: { 'Authorization': 'Bearer ' + token }
      });
      if (res.ok) location.reload();
      else alert('Failed to delete');
    }

    function logout() {
      localStorage.removeItem('adminToken');
      window.location.href = '/client/admin/login.html';
    }
  </script>
</body>
</html>
